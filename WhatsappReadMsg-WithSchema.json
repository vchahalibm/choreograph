{
  "title": "WhatsApp Read Messages",
  "targetUrl": "https://web.whatsapp.com",
  "description": "Searches WhatsApp contacts and reads their messages",
  "parameters": {
    "searchText1": "R94",
    "searchText2": "Rustambagh"
  },
  "outputSchema": {
    "description": "WhatsApp chat data including contact info and messages",
    "fields": [
      {
        "name": "username",
        "type": "string",
        "description": "Contact or group name from WhatsApp",
        "path": "$.chat.username"
      },
      {
        "name": "messages",
        "type": "array",
        "description": "Array of message objects from the chat",
        "path": "$.chat.messages"
      },
      {
        "name": "lastMessage",
        "type": "string",
        "description": "Most recent message text in the chat",
        "path": "$.chat.lastMessage"
      },
      {
        "name": "messageCount",
        "type": "number",
        "description": "Total number of messages in the chat",
        "path": "$.chat.messageCount"
      },
      {
        "name": "chatInfo",
        "type": "object",
        "description": "Complete chat information object",
        "path": "$.chat"
      }
    ]
  },
  "steps": [
    {
      "type": "setViewport",
      "width": 972,
      "height": 643,
      "deviceScaleFactor": 1,
      "isMobile": false,
      "hasTouch": false,
      "isLandscape": false
    },
    {
      "type": "navigate",
      "url": "https://web.whatsapp.com/"
    },
    {
      "type": "waitForElement",
      "timeout": 10000,
      "selectors": [
        ["div[role='textbox'][contenteditable='true']"],
        ["div[data-tab='3']"],
        ["aria/Search input textbox"],
        ["#side div[contenteditable='true']"]
      ],
      "visible": true,
      "comment": "Wait for search box to appear"
    },
    {
      "type": "click",
      "selectors": [
        ["div[role='textbox'][contenteditable='true']"],
        ["div[data-tab='3']"],
        ["#side div[contenteditable='true']"]
      ],
      "comment": "Click search box"
    },
    {
      "type": "change",
      "value": "{{searchText1}}",
      "selectors": [
        ["div[role='textbox'][contenteditable='true']"],
        ["div[data-tab='3']"],
        ["#side div[contenteditable='true']"]
      ],
      "comment": "Type search text 1 in search"
    },
    {
      "type": "waitAfter",
      "duration": 1000,
      "comment": "Wait for search results to appear"
    },
    {
      "type": "waitForElement",
      "selectors": [
        ["button[aria-label*='Cancel']"],
        ["button[aria-label*='Clear']"],
        ["span[data-icon='x-alt']"]
      ],
      "visible": true,
      "timeout": 5000,
      "comment": "Wait for cancel/clear button"
    },
    {
      "type": "click",
      "selectors": [
        ["button[aria-label*='Cancel']"],
        ["button[aria-label*='Clear']"],
        ["span[data-icon='x-alt']"]
      ],
      "comment": "Click cancel to clear search"
    },
    {
      "type": "waitAfter",
      "duration": 500,
      "comment": "Wait for search box to clear"
    },
    {
      "type": "click",
      "selectors": [
        ["div[role='textbox'][contenteditable='true']"],
        ["div[data-tab='3']"]
      ],
      "comment": "Click search box again"
    },
    {
      "type": "change",
      "value": "{{searchText2}}",
      "selectors": [
        ["div[role='textbox'][contenteditable='true']"],
        ["div[data-tab='3']"]
      ],
      "comment": "Type search text 2 in search"
    },
    {
      "type": "waitAfter",
      "duration": 1500,
      "comment": "Wait for search results"
    },
    {
      "type": "waitForElement",
      "selectors": [
        ["#pane-side div[role='row']"],
        ["div[data-testid='cell-frame-container']"]
      ],
      "visible": true,
      "timeout": 5000,
      "comment": "Wait for chat result to appear"
    },
    {
      "type": "click",
      "selectors": [
        ["#pane-side div[role='row']:nth-child(2) div[role='gridcell']"],
        ["div[role='grid'] > div[role='row']:nth-child(2) div[role='gridcell']"],
        ["#pane-side div[role='row']:nth-child(2)"]
      ],
      "comment": "Click gridcell inside first search result row"
    },
    {
      "type": "waitAfter",
      "duration": 1000,
      "comment": "Wait for chat to load"
    }
  ]
}
